<template name="admin">
	{{> registeredUsers}}
	<div class="row">
		{{> availableGlyphsets}}
		{{> possibleGlyphsets}}
	</div>
	{{> addingModal}}
</template>

<template name="possibleGlyphsets">
	<div class="col-sm-7 column">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h5 class="panel-title">Possible Glyphsets: {{glyphsetCount}}</h5>
			</div>
			<table class="table table-default">
				<thead>
					<tr>
						<th></th>
						<th>P.</th>
						{{#each keysOf googleLangs}}
							<th>
								<span class="visible-sm visible-xs">{{tinyLanguageName this}}</span>
								<span class="hidden-sm hidden-xs">{{shortLanguageName this}}</span>
							</th>
						{{/each}}
						<th>Engs.</th>
						<th>Pro.</th>
					</tr>
				</thead>
				<tbody>
					{{#each glyphsets}}
						<tr>
							<td>
								<button class="btn btn-default btn-sm save-possible-glyphset"
									data-toggle="modal" data-target=".adding-glyph-modal">
									<i class="glyphicon glyphicon-chevron-left"></i>
								</button>
							</td>
							<td>
								{{this.pop}}
							</td>
							{{#each keysOf googleLangs}}
								{{#if equals this 'e'}}
									<td class="eng-cell" lang="en">
										{{#if equals bestEngs.length 1}}
											{{#if equals allEngs.length 1}}
												<strong>{{> englishCell engs=bestEngs}}</strong>
											{{else}}
												<strong>{{> englishCell engs=bestEngs title=allEngs}}</strong>
											{{/if}}
										{{else}}
											{{> englishCell engs=bestEngs text='BESTS:'}}
											{{#with allEngs}}
												{{> englishCell engs=this _id=../../_id}}
											{{/with}}
										{{/if}}
									</td>
									<td title={{allEngs}}>
										{{allEngs.length}}
									</td>
								{{else}}
									<td lang="{{googleLangOf this}}">
										<a href="https://translate.google.com/#auto/en/{{propOfObj this ..}}" target="_blank">
											{{propOfObj this ..}}
										</a>
									</td>
								{{/if}}
							{{/each}}
							<td title={{pronunciationsSummary}}>
								{{pronunciations}}
							</td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
	</div>
</template>

<template name="addingModal">
	<div id="adding-glyph-modal" class="modal fade adding-glyph-modal" tabindex="-1" role="dialog">
	  <div class="modal-dialog">
			{{#with newGlyph}}
		    <div class="modal-content">
		    	<div class="modal-body">
						<div class="input-group">
							<label class="input-group-addon">Manual:</label>
							{{#if equals bestEngs.length 1}}
								<input type="text" class="form-control new-glyph-english" placeholder="Enter main english key manually..." value="{{bestEngs}}" />
							{{else}}
								<input type="text" class="form-control new-glyph-english" placeholder="Enter main english key manually..." />
							{{/if}}
						</div>
						<div class="english-list text-center">
							{{> englishCell engs=allEngs _id=../_id}}
						</div>
		    	</div>
			    <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="button" class="btn btn-primary save-new-glyph">Save changes</button>
			  	</div>
		    </div>
			{{/with}}
	  </div>
	</div>
</template>

<template name="englishCell">
	{{#if engs}}
		{{#each engs}}
			<div>
				<a class="btn btn-link save-potential" title={{../title}}>
					{{#if ../text}}{{../text}} {{/if}}{{this}}
				</a>
			</div>
		{{/each}}
	{{/if}}
</template>

<template name="pronounceCell">
	{{#if langs}}
		{{#each langs}}
			<div>
				{{#if ../text}}{{../text}} {{/if}}{{this}}
			</div>
		{{/each}}
	{{/if}}
</template>

<template name="availableGlyphsets">
	<div class="col-sm-5 column">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h5 class="panel-title">Available Glyphsets: {{glyphsetCount}}</h5>
			</div>
			<table class="table table-default">
				<thead>
					<tr>
						<th></th>
						{{#each keysOf googleLangs}}
							<th>
								<span class="visible-sm visible-xs">{{tinyLanguageName this}}</span>
								<span class="hidden-sm hidden-xs">{{shortLanguageName this}}</span>
							</th>
						{{/each}}
					</tr>
				</thead>
				<tbody>
					{{#each glyphsets}}
						<tr>
							<td>{{this.pop}}</td>
							{{#each keysOf googleLangs}}
								<td lang="{{googleLangOf this}}">{{propOfObj this ..}}</td>
							{{/each}}
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
	</div>
</template>

<template name="registeredUsers">
	<div class="row">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h5 class="panel-title">Registered users: {{userNumber}}</h5>
			</div>
			<table class="table table-default">
				<thead>
					<tr>
						<th>Email</th>
						<th>Score</th>
					</tr>
				</thead>
				<tbody>
					{{#each userScores}}
						<tr>
							<td>{{#if profile.name}}{{profile.name}}{{else}}{{#each emails}}{{address}}{{/each}}{{/if}}</td>
							<td>{{profile.score}}</td>
						</tr>
					{{/each}}
				</tbody>
			</table>
		</div>
	</div>
</template>